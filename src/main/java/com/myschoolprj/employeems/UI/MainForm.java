package com.myschoolprj.employeems.UI;

import com.myschoolprj.employeems.Barchart;
import com.myschoolprj.employeems.utils.Validator;
import com.myschoolprj.employeems.utils.GradientPanels;
import com.myschoolprj.employeems.utils.jPanelGradient2;
import com.myschoolprj.employeems.utils.PlaceholderUtils;
import com.myschoolprj.employeems.dao.EmployeeDAO;
import com.myschoolprj.employeems.model.Employee;
import com.myschoolprj.employeems.dao.RoleDAO;
import com.myschoolprj.employeems.model.Role;
import com.myschoolprj.employeems.dao.SalaryDAO;
import com.myschoolprj.employeems.dao.EmployeeImport;
import com.myschoolprj.employeems.model.Salary;

import javax.swing.*;
import java.awt.*;
import java.util.ArrayList;
import java.util.List;
import java.util.Date;
import java.text.*;
import java.util.Map;
import java.util.HashMap;

import java.awt.Color;
import java.sql.SQLException;
import java.time.Year;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

public class MainForm extends javax.swing.JFrame {

    private EmployeeDAO emDAO;
    private RoleDAO roleDAO;
    private SalaryDAO salaryDAO;

    public MainForm() {
        initComponents();

        // Khởi tạo đối tượng EmployeeDAO
        try {
            emDAO = new EmployeeDAO(); // Khởi tạo EmployeeDAO

            // Khởi tạo đối tượng count_em từ EmployeeDAO và truyền JLabel vào
            EmployeeDAO.count_em countEmployee = emDAO.new count_em(total, total_staff, total_leader);
            countEmployee.TotalEmployee(); // Gọi phương thức TotalEmployee để lấy tổng số nhân viên và cập nhật JLabel
            countEmployee.TotalEmployeeWithRole("Staff"); // Đếm nhân viên có role staff
            countEmployee.TotalEmployeeWithRole("Leader"); // Đếm nhân viên có role leader

        } catch (SQLException e) {
            e.printStackTrace(); // Xử lý ngoại lệ nếu có lỗi kết nối cơ sở dữ liệu
        }

        // tải data từ db lên bảng
        try {
            emDAO = new EmployeeDAO();
            roleDAO = new RoleDAO();
            salaryDAO = new SalaryDAO();
        } catch (SQLException e) {
            Validator.printSQLExceptionMessage(e);
            e.printStackTrace();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "An unexpected error occurred: " + e.getMessage(), "Error",
                    JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
        }
        loadDataIntoEmTable();
        loadDataIntoSalaryTable();
        loadDataIntoMonSalTable();

        // Khởi tạo Barchart
        Barchart barchart = new Barchart();
        jPanel10.setLayout(new BorderLayout()); // Đặt layout cho jPanel7

        jPanel10.add(barchart, BorderLayout.CENTER); // Thêm biểu đồ vào jPanel7
        jPanel10.setPreferredSize(new Dimension(600, 300)); // Đặt kích thước cho jPanel7
        jPanel10.revalidate(); // Cập nhật lại panel
        jPanel10.repaint(); // Vẽ lại panel
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        closeMainBtn = new javax.swing.JButton();
        jPanel2 = new GradientPanels(Color.decode("#272b3f"), Color.decode("#256b51"));
        jButton1 = new javax.swing.JButton();
        Logout_button = new javax.swing.JLabel();
        jPanel8 = new javax.swing.JPanel();
        javax.swing.JButton homeBtn = new javax.swing.JButton();
        addEmBtn = new javax.swing.JButton();
        salaryBtn = new javax.swing.JButton();
        jPanel19 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jPanel6 = new jPanelGradient2(20, Color.cyan, Color.DARK_GRAY, Color.BLACK);
        jLabel5 = new javax.swing.JLabel();
        total = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jPanel7 = new jPanelGradient2(20, Color.cyan, Color.DARK_GRAY, Color.BLACK);
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        total_leader = new javax.swing.JLabel();
        jPanel9 = new jPanelGradient2(20, Color.cyan, Color.DARK_GRAY, Color.BLACK);
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        total_staff = new javax.swing.JLabel();
        jPanel10 = new javax.swing.JPanel();
        jPanel11 = new javax.swing.JPanel();
        jPanel12 = new javax.swing.JPanel();
        jLabel14 = new javax.swing.JLabel();
        searchTF = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        emTB = new javax.swing.JTable();
        lblStatus = new javax.swing.JLabel();
        jPanel13 = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        txtEmID = new javax.swing.JTextField();
        jLabel16 = new javax.swing.JLabel();
        txtPhone = new javax.swing.JTextField();
        cbAddress = new javax.swing.JComboBox<>();
        jLabel17 = new javax.swing.JLabel();
        txtFirstName = new javax.swing.JTextField();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        txtLastName = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        cbGender = new javax.swing.JComboBox<>();
        clearEmDataBtn = new javax.swing.JButton();
        addEmDataBtn = new javax.swing.JButton();
        updateBtn = new javax.swing.JButton();
        deleteBtn = new javax.swing.JButton();
        jDate = new com.toedter.calendar.JDateChooser();
        jLabel29 = new javax.swing.JLabel();
        cbRole = new javax.swing.JComboBox<>();
        jLabel30 = new javax.swing.JLabel();
        jLabel34 = new javax.swing.JLabel();
        cbPosition = new javax.swing.JComboBox<>();
        bttn_import = new javax.swing.JButton();
        jLabel6 = new javax.swing.JLabel();
        jPanel15 = new javax.swing.JPanel();
        jPanel16 = new javax.swing.JPanel();
        jLabel23 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        clearSalEmBtn = new javax.swing.JButton();
        updateSalaryBtn = new javax.swing.JButton();
        salSearchTF = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        jLabel33 = new javax.swing.JLabel();
        calculateBaseNetBtn = new javax.swing.JButton();
        emSalIdTF = new javax.swing.JTextField();
        emSalFirstnameTF = new javax.swing.JTextField();
        emSalLastnameTF = new javax.swing.JTextField();
        emSalCoefTF = new javax.swing.JTextField();
        emSalAllowanceTF = new javax.swing.JTextField();
        emSalBaseTF = new javax.swing.JTextField();
        emSalNetTF = new javax.swing.JTextField();
        jLabel35 = new javax.swing.JLabel();
        totalWorkDayTF = new javax.swing.JTextField();
        mthlb = new javax.swing.JLabel();
        monthTF = new javax.swing.JTextField();
        emMonthSalTF = new javax.swing.JTextField();
        jLabel36 = new javax.swing.JLabel();
        calculateMonBtn = new javax.swing.JButton();
        emSalRoleIDTF = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        yearlb = new javax.swing.JLabel();
        yearTF = new javax.swing.JTextField();
        jPanel18 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        salaryTB = new javax.swing.JTable();
        jPanel14 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        monthSalTB = new javax.swing.JTable();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setUndecorated(true);
        setResizable(false);
        setSize(new java.awt.Dimension(1140, 500));
        addWindowFocusListener(new java.awt.event.WindowFocusListener() {
            public void windowGainedFocus(java.awt.event.WindowEvent evt) {
                formWindowGainedFocus(evt);
            }
            public void windowLostFocus(java.awt.event.WindowEvent evt) {
            }
        });

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));
        jPanel1.setForeground(new java.awt.Color(0, 0, 0));

        jLabel4.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N
        jLabel4.setText("Employee Management System  ");

        closeMainBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-x-24.png"))); // NOI18N
        closeMainBtn.setBorder(null);
        closeMainBtn.setBorderPainted(false);
        closeMainBtn.setContentAreaFilled(false);
        closeMainBtn.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        closeMainBtn.setFocusPainted(false);
        closeMainBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                closeMainBtnActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 266, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(closeMainBtn)
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(closeMainBtn)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, 27, Short.MAX_VALUE))
                .addContainerGap())
        );

        jButton1.setBackground(new java.awt.Color(0, 153, 102));
        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-logout-24.png"))); // NOI18N
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        Logout_button.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        Logout_button.setForeground(new java.awt.Color(255, 255, 255));
        Logout_button.setText("Logout");

        jPanel8.setPreferredSize(new java.awt.Dimension(159, 117));
        jPanel8.setOpaque(false);

        homeBtn.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        homeBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/home-icon.png"))); // NOI18N
        homeBtn.setText("Home ");
        homeBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                homeBtnActionPerformed(evt);
            }
        });

        addEmBtn.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        addEmBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/pluss-icon.png"))); // NOI18N
        addEmBtn.setText("Add Employee");
        addEmBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addEmBtnActionPerformed(evt);
            }
        });

        salaryBtn.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        salaryBtn.setForeground(new java.awt.Color(0, 0, 0));
        salaryBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/money-icon.png"))); // NOI18N
        salaryBtn.setText("Salary ");
        salaryBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                salaryBtnActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(homeBtn, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(addEmBtn, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 159, Short.MAX_VALUE)
            .addComponent(salaryBtn, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(homeBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(addEmBtn)
                .addGap(0, 4, Short.MAX_VALUE)
                .addComponent(salaryBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel19.setBorder(BorderFactory.createMatteBorder(0, 0, 3, 0, Color.WHITE));
        jPanel19.setOpaque(false);

        jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-user-100 (1).png"))); // NOI18N

        jLabel2.setFont(new java.awt.Font("Times New Roman", 0, 17)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(204, 204, 204));
        jLabel2.setText("               Welcome");

        jLabel3.setFont(new java.awt.Font("Times New Roman", 1, 17)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("                 Admin");

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addGap(43, 43, 43)
                .addComponent(jLabel1)
                .addGap(0, 44, Short.MAX_VALUE))
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel19Layout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addComponent(jLabel1)
                .addGap(6, 6, 6)
                .addComponent(jLabel2)
                .addGap(6, 6, 6)
                .addComponent(jLabel3)
                .addGap(18, 18, 18))
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(30, 30, 30)
                        .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(17, 17, 17)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(Logout_button, javax.swing.GroupLayout.PREFERRED_SIZE, 53, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(15, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(27, 27, 27)
                .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(Logout_button)
                        .addGap(8, 8, 8)))
                .addGap(18, 18, 18))
        );

        jPanel3.setLayout(new java.awt.CardLayout());

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
        jPanel5.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(153, 153, 153), 3));

        jLabel5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-staff-48.png"))); // NOI18N

        total.setFont(new java.awt.Font("Times New Roman", 1, 24)); // NOI18N
        total.setForeground(new java.awt.Color(255, 255, 255));
        total.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        total.setText("0");

        jLabel7.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(255, 255, 255));
        jLabel7.setText("Total Employees");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                        .addGap(0, 193, Short.MAX_VALUE)
                        .addComponent(total, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap())))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel7)
                .addGap(18, 18, 18))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(7, 7, 7)
                .addComponent(total, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel7.setPreferredSize(new java.awt.Dimension(267, 134));

        jLabel8.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(255, 255, 255));
        jLabel8.setText("Total Leader");

        jLabel9.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-leader-48.png"))); // NOI18N

        total_leader.setFont(new java.awt.Font("Times New Roman", 1, 24)); // NOI18N
        total_leader.setForeground(new java.awt.Color(255, 255, 255));
        total_leader.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        total_leader.setText("0");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel9)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGap(0, 151, Short.MAX_VALUE)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(total_leader, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel8))))
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(total_leader, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel9)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel8)
                .addContainerGap())
        );

        jPanel9.setPreferredSize(new java.awt.Dimension(267, 134));

        jLabel11.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(255, 255, 255));
        jLabel11.setText("Total Staff");

        jLabel12.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/user-icon-50px.png"))); // NOI18N

        total_staff.setFont(new java.awt.Font("Times New Roman", 1, 24)); // NOI18N
        total_staff.setForeground(new java.awt.Color(255, 255, 255));
        total_staff.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        total_staff.setText("0");

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(total_staff, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                .addContainerGap(156, Short.MAX_VALUE)
                .addComponent(jLabel11)
                .addGap(25, 25, 25))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(7, 7, 7)
                .addComponent(total_staff, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(7, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 58, Short.MAX_VALUE)
                .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(61, 61, 61)
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(19, 19, 19))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, 135, Short.MAX_VALUE)
                    .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, 135, Short.MAX_VALUE))
                .addContainerGap(15, Short.MAX_VALUE))
        );

        jPanel10.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, 467, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel3.add(jPanel4, "tab1");

        jPanel12.setBorder(new com.myschoolprj.employeems.utils.border(5,1)); // Thay đổi bán kính bo góc nếu cần
        jPanel12.setBackground(new java.awt.Color(255, 255, 255));
        jPanel12.setForeground(new java.awt.Color(0, 0, 0));

        jLabel14.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-search-26.png"))); // NOI18N

        searchTF.setForeground(new java.awt.Color(153, 153, 153));
        searchTF.setText("Search");
        searchTF.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                searchTFFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                searchTFFocusLost(evt);
            }
        });
        searchTF.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                searchTFActionPerformed(evt);
            }
        });
        searchTF.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                searchTFKeyReleased(evt);
            }
        });

        emTB.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 1, true));
        emTB.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Employee ID", "First name", "Last name", "Phone #", "Gender", "Date of birth", "Address", "Role", "Position"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.Object.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        emTB.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                emTBMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(emTB);
        if (emTB.getColumnModel().getColumnCount() > 0) {
            emTB.getColumnModel().getColumn(4).setPreferredWidth(25);
            emTB.getColumnModel().getColumn(7).setPreferredWidth(25);
        }

        lblStatus.setText("Status: Add/ Update");

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(searchTF, javax.swing.GroupLayout.PREFERRED_SIZE, 280, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 405, Short.MAX_VALUE)
                .addComponent(lblStatus)
                .addGap(121, 121, 121))
            .addComponent(jScrollPane1)
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(searchTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel14)
                    .addComponent(lblStatus))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 243, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel13.setBorder(new com.myschoolprj.employeems.utils.border(5,3)); // Thay đổi bán kính bo góc nếu cần
        jPanel13.setForeground(new java.awt.Color(0, 0, 0));

        jLabel15.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel15.setText("Employee ID:");

        txtEmID.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                txtEmIDKeyTyped(evt);
            }
        });

        jLabel16.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel16.setText("Phone #:");

        cbAddress.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "An Giang", "Ba Ria - Vung Tau", "Bac Lieu", "Bac Giang", "Bac Kan", "Bac Ninh", "Ben Tre", "Binh Duong", "Binh Dinh", "Binh Phuoc", "Binh Thuan", "Ca Mau", "Cao Bang", "Can Tho", "Da Nang", "Dak Lak", "Dak Nong", "Dien Bien", "Dong Nai", "Dong Thap", "Gia Lai", "Ha Giang", "Ha Nam", "Ha Noi", "Ha Tinh", "Hai Duong", "Hai Phong", "Hau Giang", "Hoa Binh", "Hung Yen", "Khanh Hoa", "Kien Giang", "Kon Tum", "Lai Chau", "Lang Son", "Lao Cai", "Lam Dong", "Long An", "Nam Dinh", "Nghe An", "Ninh Binh", "Ninh Thuan", "Phu Tho", "Phu Yen", "Quang Binh", "Quang Nam", "Quang Ngai", "Quang Ninh", "Quang Tri", "Soc Trang", "Son La", "Tay Ninh", "Thai Binh", "Thai Nguyen", "Thanh Hoa", "Thua Thien Hue", "Tien Giang", "TP Ho Chi Minh", "Tra Vinh", "Tuyen Quang", "Vinh Long", "Vinh Phuc", "Yen Bai" }));

        jLabel17.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel17.setText("Address:");

        jLabel18.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel18.setText("First name:");

        jLabel19.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel19.setText("Last name:");

        jLabel20.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel20.setText("Gender:");

        cbGender.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Male", "Female", "Other" }));

        clearEmDataBtn.setText("Clear");
        clearEmDataBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearEmDataBtnActionPerformed(evt);
            }
        });

        addEmDataBtn.setText("Add");
        addEmDataBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addEmDataBtnActionPerformed(evt);
            }
        });

        updateBtn.setText("Update");
        updateBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                updateBtnActionPerformed(evt);
            }
        });

        deleteBtn.setText("Delete");
        deleteBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                deleteBtnActionPerformed(evt);
            }
        });

        jLabel29.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel29.setText("Date:");

        cbRole.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Staff", "Leader" }));

        jLabel30.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel30.setText("Role:");

        jLabel34.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jLabel34.setText("Position:");

        cbPosition.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Frontend Developer", "Backend Developer", "Full-Stack Developer", "Mobile Developer", "Tester", "Data Engineer" }));

        bttn_import.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-file-16.png"))); // NOI18N
        bttn_import.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bttn_importActionPerformed(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("PMingLiU-ExtB", 2, 12)); // NOI18N
        jLabel6.setText("Import File Ex");

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(clearEmDataBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(addEmDataBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addGap(36, 36, 36)
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel13Layout.createSequentialGroup()
                                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel19)
                                    .addComponent(jLabel18)
                                    .addComponent(jLabel15)
                                    .addComponent(jLabel20))
                                .addGap(18, 18, 18)
                                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(txtFirstName, javax.swing.GroupLayout.PREFERRED_SIZE, 197, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(txtEmID, javax.swing.GroupLayout.PREFERRED_SIZE, 197, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(txtLastName, javax.swing.GroupLayout.PREFERRED_SIZE, 197, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(cbGender, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(jPanel13Layout.createSequentialGroup()
                                .addComponent(jLabel30)
                                .addGap(18, 18, 18)
                                .addComponent(cbRole, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(86, 86, 86)))
                        .addGap(46, 46, 46)
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel13Layout.createSequentialGroup()
                                    .addComponent(jLabel16)
                                    .addGap(12, 12, 12)
                                    .addComponent(txtPhone, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                                    .addComponent(jLabel29)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(jDate, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel13Layout.createSequentialGroup()
                                    .addComponent(jLabel34)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(cbPosition, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(jPanel13Layout.createSequentialGroup()
                                    .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(cbAddress, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGap(34, 34, 34)))
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addComponent(updateBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(deleteBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 126, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(85, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                        .addComponent(jLabel6)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(bttn_import))))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addGap(19, 19, 19)
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel15)
                            .addComponent(txtPhone, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtEmID, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel16)))
                    .addComponent(bttn_import)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel6)))
                .addGap(25, 25, 25)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtFirstName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel18)
                        .addComponent(jLabel29))
                    .addComponent(jDate, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtLastName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel19))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(cbGender, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel20))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(cbRole, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel30)))
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(cbAddress, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel17))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(cbPosition, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel34))))
                .addGap(59, 59, 59)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(clearEmDataBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(addEmDataBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(updateBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(deleteBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(11, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel13, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel12, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(0, 5, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(21, 21, 21))
        );

        jPanel3.add(jPanel11, "tab2");

        jPanel16.setBorder(new com.myschoolprj.employeems.utils.border(5,1)); // Thay đổi bán kính bo góc nếu cần

        jLabel23.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel23.setText("First name:");

        jLabel25.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel25.setText("Last name:");

        jLabel27.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel27.setText("Coef:");

        clearSalEmBtn.setText("Clear");
        clearSalEmBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearSalEmBtnActionPerformed(evt);
            }
        });

        updateSalaryBtn.setText("Update");
        updateSalaryBtn.setEnabled(false);
        updateSalaryBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                updateSalaryBtnActionPerformed(evt);
            }
        });

        salSearchTF.setForeground(new java.awt.Color(153, 153, 153));
        salSearchTF.setText("Search");
        salSearchTF.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                salSearchTFFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                salSearchTFFocusLost(evt);
            }
        });
        salSearchTF.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                salSearchTFActionPerformed(evt);
            }
        });
        salSearchTF.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                salSearchTFKeyReleased(evt);
            }
        });

        jLabel21.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/icons8-search-26.png"))); // NOI18N

        jLabel24.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel24.setText("ID:");

        jLabel31.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel31.setText("Allowance:");

        jLabel32.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel32.setText("BASE $:");

        jLabel33.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel33.setText("NET $:");

        calculateBaseNetBtn.setText("Calculate Base & Net $");
        calculateBaseNetBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                calculateBaseNetBtnActionPerformed(evt);
            }
        });

        emSalIdTF.setEditable(false);
        emSalIdTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalIdTF.setPreferredSize(new java.awt.Dimension(160, 30));

        emSalFirstnameTF.setEditable(false);
        emSalFirstnameTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalFirstnameTF.setPreferredSize(new java.awt.Dimension(73, 30));

        emSalLastnameTF.setEditable(false);
        emSalLastnameTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalLastnameTF.setPreferredSize(new java.awt.Dimension(73, 30));

        emSalCoefTF.setEditable(false);
        emSalCoefTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalCoefTF.setPreferredSize(new java.awt.Dimension(73, 30));

        emSalAllowanceTF.setPreferredSize(new java.awt.Dimension(73, 30));

        emSalBaseTF.setEditable(false);
        emSalBaseTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalBaseTF.setPreferredSize(new java.awt.Dimension(73, 30));

        emSalNetTF.setEditable(false);
        emSalNetTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalNetTF.setPreferredSize(new java.awt.Dimension(73, 30));

        jLabel35.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel35.setText("Work day:");

        totalWorkDayTF.setMinimumSize(new java.awt.Dimension(68, 24));
        totalWorkDayTF.setPreferredSize(new java.awt.Dimension(160, 30));

        mthlb.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        mthlb.setText("Month:");

        monthTF.setPreferredSize(new java.awt.Dimension(73, 30));

        emMonthSalTF.setEditable(false);
        emMonthSalTF.setBackground(new java.awt.Color(211, 211, 211));
        emMonthSalTF.setPreferredSize(new java.awt.Dimension(73, 30));

        jLabel36.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel36.setText("Month $:");

        calculateMonBtn.setText("Calculate Month $");
        calculateMonBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                calculateMonBtnActionPerformed(evt);
            }
        });

        emSalRoleIDTF.setBackground(new java.awt.Color(211, 211, 211));
        emSalRoleIDTF.setPreferredSize(new java.awt.Dimension(73, 30));

        jLabel22.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        jLabel22.setText("Role ID:");

        yearlb.setFont(new java.awt.Font("Times New Roman", 0, 14)); // NOI18N
        yearlb.setText("Year:");

        yearTF.setPreferredSize(new java.awt.Dimension(73, 30));

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel16Layout.createSequentialGroup()
                                .addComponent(jLabel21)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(salSearchTF, javax.swing.GroupLayout.PREFERRED_SIZE, 244, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel16Layout.createSequentialGroup()
                                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel32)
                                    .addComponent(jLabel33)
                                    .addComponent(jLabel36))
                                .addGap(9, 9, 9)
                                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(emSalBaseTF, javax.swing.GroupLayout.PREFERRED_SIZE, 208, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(emSalNetTF, javax.swing.GroupLayout.PREFERRED_SIZE, 205, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(emMonthSalTF, javax.swing.GroupLayout.PREFERRED_SIZE, 205, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel16Layout.createSequentialGroup()
                                    .addComponent(jLabel25)
                                    .addGap(18, 18, 18)
                                    .addComponent(emSalLastnameTF, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel16Layout.createSequentialGroup()
                                    .addComponent(jLabel23)
                                    .addGap(18, 18, 18)
                                    .addComponent(emSalFirstnameTF, javax.swing.GroupLayout.DEFAULT_SIZE, 181, Short.MAX_VALUE))
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel16Layout.createSequentialGroup()
                                    .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel22)
                                        .addComponent(jLabel24))
                                    .addGap(33, 33, 33)
                                    .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(emSalIdTF, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(emSalRoleIDTF, javax.swing.GroupLayout.DEFAULT_SIZE, 181, Short.MAX_VALUE))))
                            .addGroup(jPanel16Layout.createSequentialGroup()
                                .addComponent(jLabel31)
                                .addGap(18, 18, 18)
                                .addComponent(emSalAllowanceTF, javax.swing.GroupLayout.PREFERRED_SIZE, 179, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel16Layout.createSequentialGroup()
                                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel27)
                                    .addComponent(mthlb)
                                    .addComponent(jLabel35)
                                    .addComponent(yearlb))
                                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel16Layout.createSequentialGroup()
                                        .addGap(18, 18, 18)
                                        .addComponent(emSalCoefTF, javax.swing.GroupLayout.PREFERRED_SIZE, 181, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel16Layout.createSequentialGroup()
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(yearTF, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(monthTF, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(totalWorkDayTF, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 181, Short.MAX_VALUE)))))
                            .addGroup(jPanel16Layout.createSequentialGroup()
                                .addComponent(calculateBaseNetBtn)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(calculateMonBtn))))
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addGap(48, 48, 48)
                        .addComponent(clearSalEmBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(updateSalaryBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(0, 5, Short.MAX_VALUE))
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGap(11, 11, 11)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addGap(6, 6, 6)
                        .addComponent(salSearchTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel21))
                .addGap(29, 29, 29)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel24)
                    .addComponent(emSalIdTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel22)
                    .addComponent(emSalRoleIDTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(11, 11, 11)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel23)
                    .addComponent(emSalFirstnameTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel25)
                    .addComponent(emSalLastnameTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(totalWorkDayTF, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel35))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(monthTF, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(mthlb))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(yearTF, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(yearlb))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel27)
                    .addComponent(emSalCoefTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel31)
                    .addComponent(emSalAllowanceTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(calculateMonBtn, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(calculateBaseNetBtn, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(33, 33, 33)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel32)
                    .addComponent(emSalBaseTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel33)
                    .addComponent(emSalNetTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel36)
                    .addComponent(emMonthSalTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(updateSalaryBtn, javax.swing.GroupLayout.DEFAULT_SIZE, 33, Short.MAX_VALUE)
                    .addComponent(clearSalEmBtn, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        jPanel18.setBorder(new com.myschoolprj.employeems.utils.border(5,1)); // Thay đổi bán kính bo góc nếu cần
        jPanel18.setBackground(new java.awt.Color(255, 255, 255));

        salaryTB.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Employee ID", "Role ID", "First name", "Last name", "Coef", "Allowance", "Base Salary $", "Net Salary $"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.Float.class, java.lang.Float.class, java.lang.Float.class, java.lang.Float.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        salaryTB.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                salaryTBMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(salaryTB);
        if (salaryTB.getColumnModel().getColumnCount() > 0) {
            salaryTB.getColumnModel().getColumn(0).setPreferredWidth(55);
            salaryTB.getColumnModel().getColumn(1).setPreferredWidth(35);
            salaryTB.getColumnModel().getColumn(2).setPreferredWidth(45);
            salaryTB.getColumnModel().getColumn(3).setPreferredWidth(45);
            salaryTB.getColumnModel().getColumn(4).setPreferredWidth(20);
            salaryTB.getColumnModel().getColumn(5).setPreferredWidth(40);
        }

        javax.swing.GroupLayout jPanel18Layout = new javax.swing.GroupLayout(jPanel18);
        jPanel18.setLayout(jPanel18Layout);
        jPanel18Layout.setHorizontalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 646, Short.MAX_VALUE)
        );
        jPanel18Layout.setVerticalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 278, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        jPanel14.setBorder(new com.myschoolprj.employeems.utils.border(5,1)); // Thay đổi bán kính bo góc nếu cần

        monthSalTB.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Salary ID", "Employee ID", "First name", "Last name", "Work day", "Month Salary $", "Month", "Year"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.Object.class, java.lang.Float.class, java.lang.Integer.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane4.setViewportView(monthSalTB);
        if (monthSalTB.getColumnModel().getColumnCount() > 0) {
            monthSalTB.getColumnModel().getColumn(0).setPreferredWidth(40);
            monthSalTB.getColumnModel().getColumn(1).setPreferredWidth(55);
            monthSalTB.getColumnModel().getColumn(2).setPreferredWidth(45);
            monthSalTB.getColumnModel().getColumn(3).setPreferredWidth(45);
            monthSalTB.getColumnModel().getColumn(4).setPreferredWidth(35);
            monthSalTB.getColumnModel().getColumn(6).setPreferredWidth(25);
            monthSalTB.getColumnModel().getColumn(7).setPreferredWidth(25);
        }

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane4, javax.swing.GroupLayout.Alignment.TRAILING)
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 355, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel16, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel18, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addComponent(jPanel18, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );

        jPanel3.add(jPanel15, "tab3");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(7, 7, 7)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void searchTFActionPerformed(java.awt.event.ActionEvent evt) {
        String searchInput = searchTF.getText().trim(); // Get input from the search field
        // Check input validity
        if (searchInput.isEmpty() || searchInput.equals("Search")) {
            JOptionPane.showMessageDialog(this, "Please enter a valid ID or name to search.", "Input Error", JOptionPane.ERROR_MESSAGE);
            return;
        }

        // Call the search method for the employee table
        searchByInput(searchInput, emTB, "employee");
    }

    private void salSearchTFKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_salSearchTFKeyReleased
        if (salSearchTF.getText().isEmpty()) {
            loadDataIntoSalaryTable(); // Gọi lại phương thức để tải lại dữ liệu vào bảng
        }
    }//GEN-LAST:event_salSearchTFKeyReleased

    private void salSearchTFFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_salSearchTFFocusGained
        PlaceholderUtils.handleFocusedPlaceholder(salSearchTF, "Search");
    }//GEN-LAST:event_salSearchTFFocusGained

    private void salSearchTFFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_salSearchTFFocusLost
        PlaceholderUtils.handleFocusedPlaceholder(salSearchTF, "Search");
    }//GEN-LAST:event_salSearchTFFocusLost

    private void salSearchTFActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_salSearchTFActionPerformed
        String searchInput = salSearchTF.getText().trim(); // Get input from the search field

        // Check input validity
        if (searchInput.isEmpty() || searchInput.equals("Search")) {
            JOptionPane.showMessageDialog(this, "Please enter a valid ID or name to search.", "Input Error", JOptionPane.ERROR_MESSAGE);
            return;
        }

        // Call the search method for the salary table
        searchByInput(searchInput, salaryTB, "salary");
    }//GEN-LAST:event_salSearchTFActionPerformed

    private void searchTFKeyReleased(java.awt.event.KeyEvent evt) {
        if (searchTF.getText().isEmpty()) {
            loadDataIntoEmTable();
        }
    }

    private void clearSalEmBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clearSalEmBtnActionPerformed
        emSalIdTF.setText("");
        emSalRoleIDTF.setText("");
        emSalFirstnameTF.setText("");
        emSalLastnameTF.setText("");
        totalWorkDayTF.setText("");
        monthTF.setText("");
        yearTF.setText("");
        emSalCoefTF.setText("");
        emSalAllowanceTF.setText("");
        emSalBaseTF.setText("");
        emSalNetTF.setText("");
        emMonthSalTF.setText("");
        updateSalaryBtn.setEnabled(false);
    }//GEN-LAST:event_clearSalEmBtnActionPerformed

    private void updateSalaryBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_updateSalaryBtnActionPerformed
        try {
            StringBuilder sb = new StringBuilder();

            Validator.checkNumericFields(emSalAllowanceTF, sb);
            Validator.checkEmptyFields(emSalBaseTF, sb, "Do not leave Base salary blank!");
            Validator.checkEmptyFields(emSalNetTF, sb, "Do not leave Net salary blank!");
            Validator.checkEmptyFields(emMonthSalTF, sb, "Do not leave Net salary blank!");

            if (sb.length() > 0) {
                JOptionPane.showMessageDialog(this, sb.toString(), "Input Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
            String emID = emSalIdTF.getText();
            double allowance = Double.parseDouble(emSalAllowanceTF.getText().trim());

            // parse back to float value
            NumberFormat numberFormat = NumberFormat.getInstance();
            float baseSalary = numberFormat.parse(emSalBaseTF.getText()).floatValue();
            float netSalary = numberFormat.parse(emSalNetTF.getText()).floatValue();
            float monSalary = numberFormat.parse(emMonthSalTF.getText()).floatValue();

            int workday = Integer.parseInt(totalWorkDayTF.getText());
            int month = Integer.parseInt(monthTF.getText());
            int year = Integer.parseInt(yearTF.getText());

            // get specific employee's role data
            Role role = roleDAO.getSingleRoleData(emID);

            if (role == null) {
                JOptionPane.showMessageDialog(this, "No role data found for the given Employee ID.", "Error", JOptionPane.ERROR_MESSAGE);
                resetSalSectionToDefault();
                return;
            }

            if (role.getRoleName().equals("Staff") && (allowance < 0.1 || allowance > 0.8)) {
                JOptionPane.showMessageDialog(this, "Staff salary coef number must be in range of [0.1, 0.8]", "Input Error", JOptionPane.ERROR_MESSAGE);
                resetSalSectionToDefault();
                return;
            }

            if (role.getRoleName().equals("Leader") && (allowance < 0.9 || allowance > 1.5)) {
                JOptionPane.showMessageDialog(this, "Leader salary coef number must be in range of [0.9, 1.5]", "Input Error", JOptionPane.ERROR_MESSAGE);
                resetSalSectionToDefault();
                return;
            }
            // update allowance
            role.setAllowance(allowance);

            Salary salary = new Salary();
            salary.setEmId(emID);
            salary.setBaseSalary(baseSalary);
            salary.setNetSalary(netSalary);
            salary.setWorkDay(workday);
            salary.setMonSalary(monSalary);
            salary.setMonth(month);
            salary.setYear(year);

            try {
                // Thực hiện các thao tác trong giao dịch
                salaryDAO.insertSalary(salary, role);  // Thêm dữ liệu lương
                salaryDAO.updateSalary(salary, role);  // Cập nhật dữ liệu lương
               
                // Cập nhật bảng lương trên giao diện
                loadDataIntoSalaryTable();
                loadDataIntoMonSalTable();
            } catch (Exception e) {          
                JOptionPane.showMessageDialog(this, "An unexpected error occurred: " + e.getMessage(), "Error",
                    JOptionPane.ERROR_MESSAGE);
                e.printStackTrace();
            }

            // clear fields after updating
            emSalIdTF.setText("");
            emSalRoleIDTF.setText("");
            emSalFirstnameTF.setText("");
            emSalLastnameTF.setText("");
            totalWorkDayTF.setText("");
            monthTF.setText("");
            emSalCoefTF.setText("");
            emSalAllowanceTF.setText("");
            emSalBaseTF.setText("");
            emSalNetTF.setText("");
            emMonthSalTF.setText("");
            updateSalaryBtn.setEnabled(false);
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "An unexpected error occurred: " + e.getMessage(), "Error",
                    JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
        }
    }//GEN-LAST:event_updateSalaryBtnActionPerformed


    private void txtEmIDKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtEmIDKeyTyped
        Validator.checkContentSpaces(evt);
    }//GEN-LAST:event_txtEmIDKeyTyped

    private void calculateBaseNetBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_calculateBaseNetBtnActionPerformed
        StringBuilder sb = new StringBuilder();

        Validator.checkNumericFields(emSalCoefTF, sb);
        Validator.checkNumericFields(emSalAllowanceTF, sb);

        if (sb.length() > 0) {
            JOptionPane.showMessageDialog(this, sb.toString(), "Input Error", JOptionPane.ERROR_MESSAGE);
            return;
        }

        if (Float.parseFloat(emSalAllowanceTF.getText()) <= 0 || Float.parseFloat(emSalCoefTF.getText()) <= 0) {
            JOptionPane.showMessageDialog(this, "Please enter value greater than 0", "Input Error", JOptionPane.ERROR_MESSAGE);
            emSalCoefTF.setBackground(Color.decode("#D3D3D3"));
            updateBtn.setEnabled(false);
            return;
        }
        float allowance = Float.parseFloat(emSalAllowanceTF.getText());
        float coef = Float.parseFloat(emSalCoefTF.getText());
        // calculate salaries
        float baseSalary = 2340000 * coef;
        float netSalary = baseSalary + baseSalary * allowance;

        // Format the salaries
        NumberFormat numberFormat = NumberFormat.getInstance();
        numberFormat.setMinimumFractionDigits(2);
        numberFormat.setMaximumFractionDigits(2);

        emSalBaseTF.setText(numberFormat.format(baseSalary));
        emSalNetTF.setText(numberFormat.format(netSalary));
        emSalCoefTF.setBackground(Color.decode("#D3D3D3"));
        updateSalaryBtn.setEnabled(true);
    }//GEN-LAST:event_calculateBaseNetBtnActionPerformed

    private void closeMainBtnActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_closeMainBtnActionPerformed
        this.dispose();
    }

    private void bttn_importActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bttn_importActionPerformed
        JFileChooser fileChooser = new JFileChooser();
        if (fileChooser.showOpenDialog(null) == JFileChooser.APPROVE_OPTION) {
            String filePath = fileChooser.getSelectedFile().getAbsolutePath();
            try {
                EmployeeImport employeeImport = new EmployeeImport();
                List<Employee> employees = employeeImport.readEmployeesFromExcel(filePath);
                employeeImport.saveEmployeeToDatabase(employees);
                JOptionPane.showMessageDialog(null, "Import thành công!", "Thành công", JOptionPane.INFORMATION_MESSAGE);
                loadDataIntoEmTable();
            } catch (Exception ex) {
                ex.printStackTrace();
                JOptionPane.showMessageDialog(null, "Lỗi: " + ex.getMessage(), "Lỗi", JOptionPane.ERROR_MESSAGE);
            }
        }
    }//GEN-LAST:event_bttn_importActionPerformed

    private void calculateMonBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_calculateMonBtnActionPerformed
        StringBuilder sb = new StringBuilder();

        Validator.checkNumericFields(emSalCoefTF, sb);
        Validator.checkNumericFields(emSalAllowanceTF, sb);
        Validator.checkValidRange(totalWorkDayTF, sb, 0, 26);
        Validator.checkValidRange(monthTF, sb, 1, 12);
        // công ty thành lập từ năm 2023 :>
        Validator.checkValidRange(yearTF, sb, 2023, Year.now().getValue());

        if (sb.length() > 0) {
            JOptionPane.showMessageDialog(this, sb.toString(), "Input Error", JOptionPane.ERROR_MESSAGE);
            return;
        }

        if (Float.parseFloat(emSalAllowanceTF.getText()) <= 0 || Float.parseFloat(emSalCoefTF.getText()) <= 0) {
            JOptionPane.showMessageDialog(this, "Please enter value greater than 0", "Input Error", JOptionPane.ERROR_MESSAGE);
            emSalCoefTF.setBackground(Color.decode("#D3D3D3"));
            return;
        }
        float allowance = Float.parseFloat(emSalAllowanceTF.getText());
        float coef = Float.parseFloat(emSalCoefTF.getText());
        int workday = Integer.parseInt(totalWorkDayTF.getText());
        // calculate salaries
        float baseSalary = 2340000 * coef;
        float netSalary = baseSalary + baseSalary * allowance;
        float monthSal = (netSalary / 26) * workday;

        // Format the salaries
        NumberFormat numberFormat = NumberFormat.getInstance();
        numberFormat.setMinimumFractionDigits(2);
        numberFormat.setMaximumFractionDigits(2);

        emMonthSalTF.setText(numberFormat.format(monthSal));
        updateSalaryBtn.setEnabled(true);
    }//GEN-LAST:event_calculateMonBtnActionPerformed

    private void salaryTBMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_salaryTBMouseClicked
        int selectedRow = salaryTB.getSelectedRow();

        if (selectedRow >= 0) {
            // get data from selected row in salary table
            String id = salaryTB.getValueAt(selectedRow, 0).toString();
            String roleID = salaryTB.getValueAt(selectedRow, 1).toString();
            String first_name = salaryTB.getValueAt(selectedRow, 2).toString();
            String last_name = salaryTB.getValueAt(selectedRow, 3).toString();
            String coef = salaryTB.getValueAt(selectedRow, 4).toString();
            String allowance = salaryTB.getValueAt(selectedRow, 5).toString();
            // Get and format Float values for baseSalary and netSalary
            Float baseSalary = (Float) salaryTB.getValueAt(selectedRow, 6);
            Float netSalary = (Float) salaryTB.getValueAt(selectedRow, 7);

            // Use String.format() for consistent formatting
            String baseSalaryFormatted = String.format("%,.2f", baseSalary);
            String netSalaryFormatted = String.format("%,.2f", netSalary);

            // Điền dữ liệu vào các trường nhập liệu
            emSalIdTF.setText(id);
            emSalRoleIDTF.setText(roleID);
            emSalFirstnameTF.setText(first_name);
            emSalLastnameTF.setText(last_name);
            emSalCoefTF.setText(coef);
            emSalCoefTF.setBackground(Color.decode("#D3D3D3"));
            emSalAllowanceTF.setText(allowance);
            emSalBaseTF.setText(baseSalaryFormatted);
            emSalBaseTF.setBackground(Color.decode("#D3D3D3"));
            emSalNetTF.setText(netSalaryFormatted);
            emSalNetTF.setBackground(Color.decode("#D3D3D3"));
        }
    }//GEN-LAST:event_salaryTBMouseClicked

    private void addEmDataBtnActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_addEmDataBtnActionPerformed
        try {
            StringBuilder sb = new StringBuilder();

            Validator.checkSpecialCharacters(txtEmID, sb, "Employee cannot be blank!");
            Validator.checkSpecialCharacters(txtFirstName, sb, "First name cannot be blank!");
            Validator.checkSpecialCharacters(txtLastName, sb, "Last name cannot be blank!");
            Validator.checkEmptyComboBoxes(cbGender, sb, "Gender cannot be blank!");
            Validator.checkEmptyComboBoxes(cbRole, sb, "Role cannot be blank!");
            Validator.checkValidPhone(txtPhone, sb);
            Validator.checkValidDOB(jDate, sb);
            Validator.checkEmptyComboBoxes(cbAddress, sb, "Address cannot be blank !");
            Validator.checkEmptyComboBoxes(cbPosition, sb, "Position cannot be blank!");

            if (sb.length() > 0) {
                JOptionPane.showMessageDialog(this, sb.toString(), "Input Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
            String emId = txtEmID.getText().trim();

            if (emId.length() > 6) {
                JOptionPane.showMessageDialog(this, "Employee ID can't contain more than 6 characters", "Input Error",
                        JOptionPane.ERROR_MESSAGE);
                return;
            }
            String firstName = txtFirstName.getText().trim();
            String lastName = txtLastName.getText().trim();
            String gender = cbGender.getSelectedItem().toString().trim();
            String role = cbRole.getSelectedItem().toString().trim();
            String phone = txtPhone.getText().trim();
            Date date = jDate.getDate();
            String address = cbAddress.getSelectedItem().toString().trim();

            String position = cbPosition.getSelectedItem().toString().trim();
            int posID = emDAO.getPositionIDByName(position);

            // create new Employee instance
            Employee newEm = new Employee();
            newEm.setID(emId);
            newEm.setFirstName(firstName);
            newEm.setLastName(lastName);
            newEm.setPhone(phone);
            newEm.setGender(gender);
            newEm.setDob(date);
            newEm.setAddress(address);
            newEm.setPositionID(posID);

            // create new Role instance
            Role newRole = new Role();
            newRole.setEmID(emId);
            newRole.setRoleName(role);

            emDAO.addEmployeeData(newEm, newRole);
            loadDataIntoEmTable();
            loadDataIntoSalaryTable();

            clearFields();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "An unexpected error occurred: " + e.getMessage(), "Error",
                    JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
        }
        lblStatus.setText("Status: Add new");
    }

    private void clearEmDataBtnActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_clearEmDataBtnActionPerformed
        txtEmID.setText("");
        txtEmID.setEditable(true);
        txtEmID.setBackground(Color.WHITE);
        txtFirstName.setText("");
        txtLastName.setText("");
        cbGender.setSelectedItem(null);
        cbRole.setSelectedItem(null);
        txtPhone.setText("");
        jDate.setDate(null);
        cbAddress.setSelectedItem(null);
        cbPosition.setSelectedItem(null);
        lblStatus.setText("Status: Clear");
    }

    private void emTBMouseClicked(java.awt.event.MouseEvent evt) {
        lblStatus.setText("Status: Data Selected");

        int selectedRow = emTB.getSelectedRow();

        if (selectedRow >= 0) {
            // get selected row data from employee table
            String employeeID = emTB.getValueAt(selectedRow, 0).toString();
            String firstName = emTB.getValueAt(selectedRow, 1).toString();
            String lastName = emTB.getValueAt(selectedRow, 2).toString();
            String phone = emTB.getValueAt(selectedRow, 3).toString();
            String gender = emTB.getValueAt(selectedRow, 4).toString();
            String dob = emTB.getValueAt(selectedRow, 5).toString();
            String address = emTB.getValueAt(selectedRow, 6).toString();
            String role = emTB.getValueAt(selectedRow, 7).toString();
            String position = emTB.getValueAt(selectedRow, 8).toString();

            // Điền dữ liệu vào các trường nhập liệu
            txtEmID.setText(employeeID);
            txtEmID.setEditable(false);
            txtEmID.setBackground(Color.decode("#D3D3D3"));
            txtFirstName.setText(firstName);
            txtLastName.setText(lastName);
            cbGender.setSelectedItem(gender);
            cbRole.setSelectedItem(role);
            txtPhone.setText(phone);

            try {
                Date date = new SimpleDateFormat("yyyy-MM-dd").parse(dob);
                jDate.setDate(date);
            } catch (ParseException e) {
                e.printStackTrace();
            }
            cbAddress.setSelectedItem(address);
            cbPosition.setSelectedItem(position);
        }
    }

    private void homeBtnActionPerformed(java.awt.event.ActionEvent evt) {
        CardLayout cl = (CardLayout) (jPanel3.getLayout());
        cl.show(jPanel3, "tab1");
    }

    private void addEmBtnActionPerformed(java.awt.event.ActionEvent evt) {
        CardLayout cl = (CardLayout) (jPanel3.getLayout());
        cl.show(jPanel3, "tab2");
    }

    private void salaryBtnActionPerformed(java.awt.event.ActionEvent evt) {
        CardLayout cl = (CardLayout) (jPanel3.getLayout());
        cl.show(jPanel3, "tab3");
    }

    private void updateBtnActionPerformed(java.awt.event.ActionEvent evt) {
        try {
            StringBuilder sb = new StringBuilder();

            // Kiểm tra các trường nhập liệu
            Validator.checkSpecialCharacters(txtEmID, sb, "Employee ID cannot be blank !");
            Validator.checkSpecialCharacters(txtFirstName, sb, "First name cannot be blank !");
            Validator.checkSpecialCharacters(txtLastName, sb, "Last name cannot be blank !");
            Validator.checkEmptyComboBoxes(cbGender, sb, "Gender cannot be blank !");
            Validator.checkEmptyComboBoxes(cbRole, sb, "Status cannot be blank !");
            Validator.checkValidPhone(txtPhone, sb);
            Validator.checkValidDOB(jDate, sb);
            Validator.checkEmptyComboBoxes(cbAddress, sb, "Address cannot be blank !");
            Validator.checkEmptyComboBoxes(cbPosition, sb, "Position cannot be blank !");

            if (sb.length() > 0) {
                JOptionPane.showMessageDialog(this, sb.toString(), "Input Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
            // Lấy thông tin từ các trường nhập liệu
            String emId = txtEmID.getText().trim();
            String firstName = txtFirstName.getText().trim();
            String lastName = txtLastName.getText().trim();
            String gender = cbGender.getSelectedItem().toString().trim();
            String role = cbRole.getSelectedItem().toString().trim();
            String phone = txtPhone.getText().trim();
            Date date = jDate.getDate();
            String address = cbAddress.getSelectedItem().toString().trim();

            String position = cbPosition.getSelectedItem().toString().trim();
            int posID = emDAO.getPositionIDByName(position);

            // Cập nhật thông tin trong cơ sở dữ liệu
            Employee employee = new Employee();
            employee.setID(emId);
            employee.setFirstName(firstName);
            employee.setLastName(lastName);
            employee.setPhone(phone);
            employee.setGender(gender);
            // Chuyển đổi ngày sang java.sql.Date
            if (date != null) {
                java.sql.Date sqlDate = new java.sql.Date(date.getTime());
                employee.setDob(sqlDate);
            } else {
                employee.setDob(null);
            }
            employee.setAddress(address);
            employee.setPositionID(posID);

            Role newRole = new Role();
            newRole.setEmID(emId);
            newRole.setRoleName(role);

            emDAO.updateEmployeeData(employee, newRole);
            loadDataIntoEmTable();
            loadDataIntoSalaryTable();
            lblStatus.setText("Status: update");
            // Xóa dữ liệu trong các trường nhập sau khi cập nhật
            clearFields();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Error: " + e.getMessage());
        }
    }

    private void deleteBtnActionPerformed(java.awt.event.ActionEvent evt) {
        int selectedRow = emTB.getSelectedRow();

        if (selectedRow >= 0) {
            // Xác nhận trước khi xóa
            int confirm = JOptionPane.showConfirmDialog(this, "Are you sure you want to delete this record?", "Confirm Delete", JOptionPane.YES_NO_OPTION);

            if (confirm == JOptionPane.YES_OPTION) {
                // Lấy ID của nhân viên từ hàng được chọn
                String emID = emTB.getValueAt(selectedRow, 0).toString().trim();

                try {
                    Role role = roleDAO.getSingleRoleData(emID);

                    if (role == null) {
                        JOptionPane.showMessageDialog(this, "No role data found for the given Employee ID.", "Error", JOptionPane.ERROR_MESSAGE);
                        return;
                    }
                    int roleID = role.getRoleId();
                    // Xóa bản ghi khỏi cơ sở dữ liệu
                    emDAO.deleteEmployee(emID, roleID); // Gọi phương thức xóa
                    loadDataIntoEmTable();
                    loadDataIntoSalaryTable();
                    loadDataIntoMonSalTable();
                } catch (Exception ex) {
                    JOptionPane.showMessageDialog(this, "Error: " + ex.getMessage());
                }
                clearFields();
            }
        } else {
            JOptionPane.showMessageDialog(this, "Please select a row to delete!", "Delete Error", JOptionPane.WARNING_MESSAGE);
        }
    }

    private void searchTFFocusGained(java.awt.event.FocusEvent evt) {
        PlaceholderUtils.handleFocusedPlaceholder(searchTF, "Search");
    }

    private void searchTFFocusLost(java.awt.event.FocusEvent evt) {
        PlaceholderUtils.handleFocusedPlaceholder(searchTF, "Search");
    }

    private void formWindowGainedFocus(java.awt.event.WindowEvent evt) {
        this.requestFocusInWindow();
    }

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
        LoginForm lg = new LoginForm();
        lg.setVisible(true);
        this.dispose();
    }

    private void searchByInput(String input, JTable tb, String tableType) {
        // Clear current table rows
        DefaultTableModel model = (DefaultTableModel) tb.getModel();
        model.setRowCount(0);

        try {
            boolean found = false;

            if (tableType.equalsIgnoreCase("employee")) {
                ArrayList<Employee> emList = emDAO.getEmployeeData(); // Fetch employee list

                for (Employee employee : emList) {
                    // Check if the input matches the ID or is contained in the name
                    if (employee.getID().toLowerCase().contains(input.toLowerCase())
                            || employee.getFirstName().toLowerCase().contains(input.toLowerCase())
                            || employee.getLastName().toLowerCase().contains(input.toLowerCase())) {

                        // Add matching employee to the table
                        Object[] rowData = {
                            employee.getID(),
                            employee.getFirstName(),
                            employee.getLastName(),
                            employee.getPhone(),
                            employee.getGender(),
                            new SimpleDateFormat("dd/MM/yyyy").format(employee.getDob()),
                            employee.getAddress(),
                            employee.getRole(),
                            employee.getPosition()
                        };
                        model.addRow(rowData);
                        found = true;
                    }
                }
            } else if (tableType.equalsIgnoreCase("salary")) {
                ArrayList<Employee> salList = emDAO.getEmployeeData(); // Fetch salary list

                for (Employee em : salList) {
                    // Check if the input matches the ID or is contained in the employee name
                    if (em.getID().toLowerCase().contains(input.toLowerCase())
                            || em.getFirstName().toLowerCase().contains(input.toLowerCase())
                            || em.getLastName().toLowerCase().contains(input.toLowerCase())) {

                        Role role = roleDAO.getSingleRoleData(em.getID());
                        // Add matching salary details to the table
                        Object[] rowData = {
                            em.getID(),
                            role.getRoleId(),
                            em.getFirstName(),
                            em.getLastName(),
                            em.getCoefLevel(),
                            em.getAllowanceLevel(),
                            em.getBaseSalary(),
                            em.getNetSalary()
                        };
                        model.addRow(rowData);
                        found = true;
                    }
                }
            }

            // Show message if no matches found
            if (!found) {
                JOptionPane.showMessageDialog(this, "No records found for: " + input, "Search Result", JOptionPane.INFORMATION_MESSAGE);
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Error loading data: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    private void loadDataIntoSalaryTable() {
        try {
            ArrayList<Employee> employees = emDAO.getEmployeeData();
            // Lấy model của JTable
            DefaultTableModel model = (DefaultTableModel) salaryTB.getModel();
            model.setRowCount(0); // Xóa tất cả các hàng hiện có trong bảng
            
            // Sử dụng Map để đảm bảo chỉ có một bản ghi cho mỗi em_id
            Map<String, Employee> uniqueEmployees = new HashMap<>();
            
            for (Employee employee : employees) {
                // Lọc dữ liệu để chỉ có một bản ghi duy nhất cho mỗi em_id
                if (!uniqueEmployees.containsKey(employee.getID())) {
                    uniqueEmployees.put(employee.getID(), employee);
                }
            }
            
            // Thêm dữ liệu vào bảng
            for (Employee employee : employees) {
                Role role = roleDAO.getSingleRoleData(employee.getID());

                Object[] rowData = {
                    employee.getID(),
                    role.getRoleId(),
                    employee.getFirstName(),
                    employee.getLastName(),
                    employee.getCoefLevel(),
                    employee.getAllowanceLevel(),
                    employee.getBaseSalary(),
                    employee.getNetSalary()
                };
                model.addRow(rowData);
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Error loading data: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    private void loadDataIntoMonSalTable() {
        try {        
            ArrayList<Salary> salaries = salaryDAO.getMonthSalData(); 
            DefaultTableModel model = (DefaultTableModel) monthSalTB.getModel();
            model.setRowCount(0);

            for (Salary sal : salaries) {
                Object[] rowData = {
                    sal.getSalId(),
                    sal.getEmId(),
                    sal.getFirstName(),
                    sal.getLastName(),
                    sal.getWorkDay(),
                    sal.getMonSalary(),
                    sal.getMonth(),
                    sal.getYear()
                };
                model.addRow(rowData);
            }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this, "Error loading data: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
        }
    }

    private void loadDataIntoEmTable() {
        try {
            ArrayList<Employee> employees = emDAO.getEmployeeData();
            // Lấy model của JTable
            DefaultTableModel model = (DefaultTableModel) emTB.getModel();
            model.setRowCount(0); // Xóa tất cả các hàng hiện có trong bảng
            // Thêm dữ liệu vào bảng
            for (Employee employee : employees) {
                Object[] rowData = {
                    employee.getID(),
                    employee.getFirstName(),
                    employee.getLastName(),
                    employee.getPhone(),
                    employee.getGender(),
                    employee.getDob(),
                    employee.getAddress(),
                    employee.getRole(),
                    employee.getPosition()
                };
                model.addRow(rowData);
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Error loading data: " + e.getMessage(), "Error",
                    JOptionPane.ERROR_MESSAGE);
        }
    }

    private void clearFields() {
        txtEmID.setText("");
        txtFirstName.setText("");
        txtLastName.setText("");
        cbGender.setSelectedItem(null);
        cbRole.setSelectedItem(null);
        txtPhone.setText("");
        cbAddress.setSelectedItem(null);
        cbPosition.setSelectedItem(null);
        jDate.setDate(null);
    }

    private void resetSalSectionToDefault() {
        emSalCoefTF.setBackground(Color.decode("#D3D3D3"));
        emSalBaseTF.setText("");
        emSalBaseTF.setBackground(Color.decode("#D3D3D3"));
        emSalNetTF.setText("");
        emSalNetTF.setBackground(Color.decode("#D3D3D3"));
        emMonthSalTF.setText("");
        emMonthSalTF.setBackground(Color.decode("#D3D3D3"));
        updateSalaryBtn.setEnabled(false);
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new MainForm().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel Logout_button;
    private javax.swing.JButton addEmBtn;
    private javax.swing.JButton addEmDataBtn;
    private javax.swing.JButton bttn_import;
    private javax.swing.JButton calculateBaseNetBtn;
    private javax.swing.JButton calculateMonBtn;
    private javax.swing.JComboBox<String> cbAddress;
    private javax.swing.JComboBox<String> cbGender;
    private javax.swing.JComboBox<String> cbPosition;
    private javax.swing.JComboBox<String> cbRole;
    private javax.swing.JButton clearEmDataBtn;
    private javax.swing.JButton clearSalEmBtn;
    private javax.swing.JButton closeMainBtn;
    private javax.swing.JButton deleteBtn;
    private javax.swing.JTextField emMonthSalTF;
    private javax.swing.JTextField emSalAllowanceTF;
    private javax.swing.JTextField emSalBaseTF;
    private javax.swing.JTextField emSalCoefTF;
    private javax.swing.JTextField emSalFirstnameTF;
    private javax.swing.JTextField emSalIdTF;
    private javax.swing.JTextField emSalLastnameTF;
    private javax.swing.JTextField emSalNetTF;
    private javax.swing.JTextField emSalRoleIDTF;
    private javax.swing.JTable emTB;
    private javax.swing.JButton jButton1;
    private com.toedter.calendar.JDateChooser jDate;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel18;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JLabel lblStatus;
    private javax.swing.JTable monthSalTB;
    private javax.swing.JTextField monthTF;
    private javax.swing.JLabel mthlb;
    private javax.swing.JTextField salSearchTF;
    private javax.swing.JButton salaryBtn;
    private javax.swing.JTable salaryTB;
    private javax.swing.JTextField searchTF;
    private javax.swing.JLabel total;
    private javax.swing.JTextField totalWorkDayTF;
    private javax.swing.JLabel total_leader;
    private javax.swing.JLabel total_staff;
    private javax.swing.JTextField txtEmID;
    private javax.swing.JTextField txtFirstName;
    private javax.swing.JTextField txtLastName;
    private javax.swing.JTextField txtPhone;
    private javax.swing.JButton updateBtn;
    private javax.swing.JButton updateSalaryBtn;
    private javax.swing.JTextField yearTF;
    private javax.swing.JLabel yearlb;
    // End of variables declaration//GEN-END:variables
}
